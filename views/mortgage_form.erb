<% if defined?(mortgage) %>
  <% m = Morgage.new(mortgage["property"].to_i,  mortgage["deposit"].to_i, mortgage["interest"].to_f, mortgage["length"].to_i, mortgage["conveyancing"].to_i, mortgage["survey"].to_i, mortgage["appreciation_rate"].to_f, mortgage["depreciation_length"].to_f ) %>
<form action='/mortgage' method='post'>
  <div class="row-fluid">
    <div class="span12">
      <div class="row-fluid"> 
        <div class="span4">
          <h3>Morgage details</h3>
          <div class="input-prepend input-append"><span class="add-on"><i class="icon-home"></i></span><input type="text" id="property" name="property" value="<%=m.property.to_i%>"></div>
          <div class="input-prepend input-append"><span class="add-on"><i class="icon-align-right"></i></span><input type="text" id="interest" name="interest" value="<%=m.interest.to_f%>"><span class="add-on">%</span></div>
          <div class="input-prepend input-append"><span class="add-on"><i class="icon-download-alt"></i></span><input type="text" id="deposit" name="deposit" value="<%=m.deposit_rate.to_i%>"><span class="add-on">%</span></div>
          <div class="input-prepend input-append"><span class="add-on"><i class="icon-calendar"></i></span><input type="text" id="length" name="length" value="<%=m.length.to_i%>"><span class="add-on">Months</span></div>
        </div>
        <div class="span4">
          <h3>Cost details</h3>
            <div class="input-prepend input-append"><span class="add-on"><i class="icon-check"></i></span><input type="text" id="survey" name="survey" value="<%=m.survey.to_i%>"></div>
            <div class="input-prepend input-append"><span class="add-on"><i class="icon-book"></i></span><input type="text" id="conveyancing" name="conveyancing" value="<%=m.conveyancing.to_i%>"></div>
            <div class="input-prepend input-append"><span class="add-on"><i class="icon-map-marker"></i></span><input type="text" id="groud_lease" name="ground_lease" value="<%=m.survey.to_i%>"></div>
            <div class="input-prepend input-append"><span class="add-on"><i class="icon-wrench"></i></span><input type="text" id="charge" name="charges" value="<%=m.survey.to_i%>"></div>
        </div>
        <div class="span4">
          <h3>Investment details</h3>
          <div class="input-prepend input-append"><span class="add-on"><i class="icon-arrow-up"></i></span><input type="text" id="appreciation_rate" name="appreciation_rate" value="<%=m.appreciation_rate.to_f%>"><span class="add-on">%</span></div>
          <div class="input-prepend input-append"><span class="add-on"><i class="icon-arrow-down"></i></span><input type="text" id="depreciation_length" name="depreciation_length" value="<%=m.depreciation_length.to_f%>"><span class="add-on">Years</span></div>
          <div class="input-prepend input-append "><span class="add-on"><i class="icon-folder-close"></i></span><span class="input-large uneditable-input"><%=m.stamp_duty.to_f.round(2)%></span></div>
        </div>
      </div>
      <input class="btn btn-inverse" type='submit' value='Breakdown'>
    </div>
  </div>
</form>
<div class="row-fluid">
  <div class="span12">
    <div class="row-fluid">
      <div class="span6">
        <h3>Breakdown</h3>
        <div class="input-prepend input-append "><span class="add-on"><i class="icon-shopping-cart"></i></span><span class="input-large uneditable-input"><%=m.principal.to_i%></span></div>
        <div class="input-prepend input-append "><span class="add-on"><i class="icon-briefcase"></i></span><span class="input-large uneditable-input"><%=m.interest_paid.to_i%></span></div>
        <div class="input-prepend input-append "><span class="add-on"><i class="icon-flag"></i></span><span class="input-large uneditable-input"><%=m.stamp_duty.to_f.round(2)%></span></div>
        <div class="input-prepend input-append "><span class="add-on"><i class="icon-share-alt"></i></span><span class="input-large uneditable-input"><%=m.stamp_duty.to_f.round(2)%></span></div>
      </div>
      <div class="span6">
        <h3>Totals</h3>
        <div class="input-prepend input-append "><span class="add-on"><i class="icon-trash"></i></span><span class="input-large uneditable-input"><%=m.overall_cost.to_f.round(2)%></span></div>
        <div class="input-prepend input-append "><span class="add-on"><i class="icon-tag"></i></span><span class="input-large uneditable-input"><%=m.overall_spending.to_f.round(2)%></span></div>
        <div class="input-prepend input-append "><span class="add-on"><i class="icon-plus"></i></span><span class="input-large uneditable-input"><%=m.appreciation.to_f.round(2)%></span></div>
        <div class="input-prepend input-append "><span class="add-on"><i class="icon-minus"></i></span><span class="input-large uneditable-input"><%=m.depreciation.to_f.round(2)%></span></div>
      </div> 
    </div>
  </div>
</div>
<div class="row-fluid">
  <div class="span12"> 
    <h3>Monthly repaiment</h3>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Month</th>
          <th>Capital</th>
          <th>Interest</th>
          <th>Balance</th>
        </tr>
      </thead>
      <tbody>
        <%m.repaiments.each do |x| %>
          <%="<tr><td>#{x["month"]}</td><td>#{x["capital"].round(2)}</td><td>#{x["interest"].round(2)}</td><td>#{x["balance"].round(2)}</td></tr>"%>
        <%end%>
      </tbody>
    </table>
  </div>
</div>
<% else %>
<form action='/mortgage' method='post'>
  <div class="row-fluid">
    <div class="span12">
      <div class="span4">
        <h3>Morgage details</h3>
        <div class="input-prepend input-append"><span class="add-on"><i class="icon-home"></i></span><input type="text" id="property" name="property" value="100000"></div>
        <div class="input-prepend input-append"><span class="add-on"><i class="icon-download-alt"></i></span><input type="text" id="deposit" name="deposit" value="30"><span class="add-on">%</span></div>
        <div class="input-prepend input-append"><span class="add-on"><i class="icon-align-right"></i></span><input type="text" id="interest" name="interest" value="4.59"><span class="add-on">%</span></div>
        <div class="input-prepend input-append"><span class="add-on"><i class="icon-calendar"></i></span><input type="text" id="length" name="length" value="60"><span class="add-on">Months</span></div>
      </div>

      <div class="span4">
        <h3>Cost details</h3>
        <div class="input-prepend input-append"><span class="add-on"><i class="icon-check"></i></span><input type="text" id="survey" name="survey" value="300"></div>
        <div class="input-prepend input-append"><span class="add-on"><i class="icon-book"></i></span><input type="text" id="conveyancing" name="conveyancing" value="1000"></div>
        <div class="input-prepend input-append"><span class="add-on"><i class="icon-arrow-up"></i></span><input type="text" id="appreciation_rate" name="appreciation_rate" value="1.4"></div>
        <div class="input-prepend input-append"><span class="add-on"><i class="icon-wrench"></i></span><input type="text" id="depreciation_length" name="depreciation_length" value="27.5"><span class="add-on">Years</span></div>
      </div> 
    </div>
  </div>

  <input class="btn btn-inverse" type='submit' value='Breakdown'>
</form>
<% end %>
